# Missing values

```{r, include=FALSE}
source('plot_missing.R')
library(mi)

knitr::opts_chunk$set(warning = FALSE,
                      message = FALSE)
```

```{r, fig.height=10, fig.width=15}
tuesdata <- tidytuesdayR::tt_load(2021, week = 38)
spotify <- tuesdata$audio_features

spotify <- spotify %>% rename(
  id = song_id,
  art = performer,
  nam = song,
  gen = spotify_genre,
  trk = spotify_track_id,
  url = spotify_track_preview_url,
  dur = spotify_track_duration_ms,
  exp = spotify_track_explicit,
  alb = spotify_track_album,
  dnc = danceability,
  eng = energy,
  key = key,
  ld = loudness,
  mde = mode,
  sph = speechiness,
  aco = acousticness,
  ins = instrumentalness,
  liv = liveness,
  val = valence,
  tem = tempo,
  sig = time_signature,
  pop = spotify_track_popularity
)

plot_missing(spotify, percent=TRUE)
```

```{r, eval=FALSE}
x <- missing_data.frame(as.data.frame(spotify))
image(x)
```

```{r, eval=FALSE}
missing_patterns <- data.frame(is.na(spotify)) %>%
  group_by_all() %>%
  count(name = "count", sort = TRUE) %>%
  ungroup()

# main plot
main_data <- missing_patterns %>%
  rownames_to_column("pattern") %>%
  pivot_longer(cols=!c(pattern,count), names_to = "key")
```

In our exploration of the dataset, we note that the `spotify_track_id` (trk) is the main column used to uniquely identify songs on Spotify. Whenever trk is missing, all of the audio features are also missing, as in Patterns 3 and 4 --- we hypothesize that this is the case because Spotify metadata and other measures cannot be accessed without the id. Pattern 10 does not follow this pattern, but only occurs in 4 rows total in the dataset. We also see that missing `spotify_track_preview_url` (url) is the second most common missing NA pattern at almost 34-35%. This feature is just a link to a 30 second preview of the song, so we don't find this pattern particularly impactful, because the feature is probably not going to be used in our project. We believe this is a MCAR "Missing Completely At Random", since around 50% of the data is missing this feature. We see that the features `song_id` (id), `artist` (art), and `song` (name) do not have any missing data. We believe this is because song_id is a unique identifier that is the concatenation of artist and song, and if song and artist were missing, the entire row would probably be missing since you would be unable to find the right song.
